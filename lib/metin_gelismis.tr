// ---------------------------------------------------------
// GELISMIS METIN KUTUPHANESI (metin_gelismis.tr)
// ---------------------------------------------------------
// Metin isleme, sifreleme, analiz fonksiyonlari

dahil_et("std_lib/liste.tr")

// ============ TEMEL METIN ISLEMLERI ============

fonksiyon metin_ters_cevir(metin) {
    // Metni karakterlere bol ve ters cevir
    karakterler = parcala(metin, "")
    ters_liste = ters_cevir(karakterler)
    dÃ¶n birlestir(ters_liste, "")
}

fonksiyon metin_uzunlugu(metin) {
    karakterler = parcala(metin, "")
    dÃ¶n uzunluk(karakterler)
}

fonksiyon palindrom_mu(metin) {
    // Palindrom kontrolu (aba, kayak gibi)
    temiz = kucuk(metin) // Buyuk-kucuk harf farki olmasin
    ters = metin_ters_cevir(temiz)
    dÃ¶n temiz == ters
}

// ============ SESLI HARF ANALIZI ============

fonksiyon sesli_harf_mi(harf) {
    h = kucuk(harf)
    eÄŸer (h == "a") dÃ¶n doÄŸru
    eÄŸer (h == "e") dÃ¶n doÄŸru
    eÄŸer (h == "i") dÃ¶n doÄŸru
    eÄŸer (h == "o") dÃ¶n doÄŸru
    eÄŸer (h == "u") dÃ¶n doÄŸru
    eÄŸer (h == "ı") dÃ¶n doÄŸru
    eÄŸer (h == "ö") dÃ¶n doÄŸru
    eÄŸer (h == "ü") dÃ¶n doÄŸru
    dÃ¶n yanlÄ±ÅŸ
}

fonksiyon sesli_harf_sayisi(metin) {
    karakterler = parcala(metin, "")
    sayac = 0
    i = 0
    l = uzunluk(karakterler)
    
    dÃ¶ngÃ¼ (i < l) {
        eÄŸer (sesli_harf_mi(karakterler[i])) {
            sayac = sayac + 1
        }
        i = i + 1
    }
    dÃ¶n sayac
}

fonksiyon sessiz_harf_sayisi(metin) {
    toplam = metin_uzunlugu(metin)
    sesli = sesli_harf_sayisi(metin)
    dÃ¶n toplam - sesli
}

// ============ KELIME ISLEMLERI ============

fonksiyon kelime_sayisi(metin) {
    kelimeler = parcala(metin, " ")
    dÃ¶n uzunluk(kelimeler)
}

fonksiyon kelime_ara(metin, aranan) {
    kelimeler = parcala(metin, " ")
    indeks = eleman_ara(kelimeler, aranan)
    dÃ¶n indeks
}

fonksiyon kelime_degistir(metin, eski, yeni) {
    kelimeler = parcala(metin, " ")
    i = 0
    l = uzunluk(kelimeler)
    
    dÃ¶ngÃ¼ (i < l) {
        eÄŸer (kelimeler[i] == eski) {
            kelimeler[i] = yeni
        }
        i = i + 1
    }
    
    dÃ¶n birlestir(kelimeler, " ")
}

// ============ SEZAR SIFRELEME ============

fonksiyon karakter_kodu(harf) {
    // Basit ASCII benzeri kodlama (a=0, b=1, ...)
    // Turkce karakterler icin genisletilmis
    h = kucuk(harf)
    
    eÄŸer (h == "a") dÃ¶n 0
    eÄŸer (h == "b") dÃ¶n 1
    eÄŸer (h == "c") dÃ¶n 2
    eÄŸer (h == "ç") dÃ¶n 3
    eÄŸer (h == "d") dÃ¶n 4
    eÄŸer (h == "e") dÃ¶n 5
    eÄŸer (h == "f") dÃ¶n 6
    eÄŸer (h == "g") dÃ¶n 7
    eÄŸer (h == "ğ") dÃ¶n 8
    eÄŸer (h == "h") dÃ¶n 9
    eÄŸer (h == "ı") dÃ¶n 10
    eÄŸer (h == "i") dÃ¶n 11
    eÄŸer (h == "j") dÃ¶n 12
    eÄŸer (h == "k") dÃ¶n 13
    eÄŸer (h == "l") dÃ¶n 14
    eÄŸer (h == "m") dÃ¶n 15
    eÄŸer (h == "n") dÃ¶n 16
    eÄŸer (h == "o") dÃ¶n 17
    eÄŸer (h == "ö") dÃ¶n 18
    eÄŸer (h == "p") dÃ¶n 19
    eÄŸer (h == "r") dÃ¶n 20
    eÄŸer (h == "s") dÃ¶n 21
    eÄŸer (h == "ş") dÃ¶n 22
    eÄŸer (h == "t") dÃ¶n 23
    eÄŸer (h == "u") dÃ¶n 24
    eÄŸer (h == "ü") dÃ¶n 25
    eÄŸer (h == "v") dÃ¶n 26
    eÄŸer (h == "y") dÃ¶n 27
    eÄŸer (h == "z") dÃ¶n 28
    
    dÃ¶n -1 // Bilinmeyen karakter
}

fonksiyon kod_karakter(kod) {
    // Kod'dan harfe donusturme
    alfabe = ["a", "b", "c", "ç", "d", "e", "f", "g", "ğ", "h", 
              "ı", "i", "j", "k", "l", "m", "n", "o", "ö", "p", 
              "r", "s", "ş", "t", "u", "ü", "v", "y", "z"]
    
    eÄŸer (kod >= 0) {
        eÄŸer (kod < uzunluk(alfabe)) {
            dÃ¶n alfabe[kod]
        }
    }
    dÃ¶n "?"
}

fonksiyon sezar_sifrele(metin, kaydirma) {
    karakterler = parcala(metin, "")
    sifreli = []
    alfabe_boyutu = 29 // Turkce alfabe
    
    i = 0
    l = uzunluk(karakterler)
    
    dÃ¶ngÃ¼ (i < l) {
        harf = karakterler[i]
        kod = karakter_kodu(harf)
        
        eÄŸer (kod == -1) {
            // Harf degil, oldugu gibi birak (bosluk, noktalama vb.)
            ekle(sifreli, harf)
        } degilse {
            // Kaydirma uygula
            yeni_kod = (kod + kaydirma) % alfabe_boyutu
            eÄŸer (yeni_kod < 0) {
                yeni_kod = yeni_kod + alfabe_boyutu
            }
            ekle(sifreli, kod_karakter(yeni_kod))
        }
        
        i = i + 1
    }
    
    dÃ¶n birlestir(sifreli, "")
}

fonksiyon sezar_coz(sifreli_metin, kaydirma) {
    // Ters kaydirma ile coz
    dÃ¶n sezar_sifrele(sifreli_metin, 0 - kaydirma)
}

// ============ SIFRE OLUSTURUCU ============

fonksiyon guvenli_sifre_olustur(uzunluk) {
    karakterler = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m",
                   "n", "o", "p", "r", "s", "t", "u", "v", "y", "z",
                   "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M",
                   "N", "O", "P", "R", "S", "T", "U", "V", "Y", "Z",
                   "0", "1", "2", "3", "4", "5", "6", "7", "8", "9",
                   "!", "@", "#", "$", "%", "&", "*"]
    
    sifre = []
    i = 0
    karakter_sayisi = uzunluk(karakterler)
    
    dÃ¶ngÃ¼ (i < uzunluk) {
        rastgele_indeks = rastgele(0, karakter_sayisi - 1)
        ekle(sifre, karakterler[rastgele_indeks])
        i = i + 1
    }
    
    dÃ¶n birlestir(sifre, "")
}

// ============ METIN ANALIZI ============

fonksiyon karakter_frekansi(metin) {
    // Basit frekans analizi (sadece ekrana yazdirir)
    karakterler = parcala(metin, "")
    
    yazdÄ±r("=== KARAKTER FREKANSI ===")
    i = 0
    l = uzunluk(karakterler)
    
    dÃ¶ngÃ¼ (i < l) {
        harf = karakterler[i]
        sayac = 0
        j = 0
        
        dÃ¶ngÃ¼ (j < l) {
            eÄŸer (karakterler[j] == harf) {
                sayac = sayac + 1
            }
            j = j + 1
        }
        
        yazdÄ±r(harf + ": " + metin(sayac) + " kez")
        i = i + 1
    }
}

