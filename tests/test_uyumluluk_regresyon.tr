// ---------------------------------------------------------
// GUMUS UYUMLULUK TESTI (test_uyumluluk_regresyon.tr)
// Eski mermilerin yeni namluda patlamadigini dogrular.
// Gecmise donuk uyumluluk (Regression) kontroludur.
// ---------------------------------------------------------

dahil_et("../lib/birim.tr")

// Tum temel kutuphaneleri dahil et (Hepsinin hala beraber calistigini gormek icin)
dahil_et("../std_lib/matematik.tr")
dahil_et("../std_lib/liste.tr")
dahil_et("../std_lib/metin.tr")
// Yeni eklenenler
dahil_et("../lib/db_yonetimi.tr")
dahil_et("../lib/guvenlik_pro.tr")

deÄŸiÅŸken t = yeni BirimTest("Uyumluluk ve Regresyon Testleri")

// ----------------------------------------------------------------
// 1. BOLUM: TEMEL FONKSIYONLARIN KARARLILIGI
// ----------------------------------------------------------------
t.bolum("CEKIRDEK UYUMLULUGU")

// En basit islemler bile bozulabilir. Kontrol edelim.
t.esit_mi(4, 2 + 2, "Matematik (2+2) hala calisiyor mu?")
t.esit_mi("merhaba dunya", "merhaba " + "dunya", "Metin birlestirme calisiyor mu?")

// deÄŸiÅŸken tanimlama ve atama
deÄŸiÅŸken a = 10
a = 20
t.esit_mi(20, a, "deÄŸiÅŸken atama mekanizmasi saglam mi?")

// ----------------------------------------------------------------
// 2. BOLUM: KUTUPHANELER ARASI ETKILESIM
// ----------------------------------------------------------------
t.bolum("CAPRAZ AGIRLIK KONTROLU")

// Senaryo: Guvenlik kutuphanesi ile Matematik kutuphanesi cakismasiz calisiyor mu?
// Ornegin: Guvenlik'teki bir hashing isleminde Matematik kutuphanesini kullanalim.

deÄŸiÅŸken sifreci = yeni Kripto()
deÄŸiÅŸken ham_veri = "GizliSayi:" + metin(mat_Ã¼s(2, 10)) // 1024

// Hem mat_Ã¼s (matematik.tr) hem de metin() (temel) hem de Kripto (guvenlik_pro.tr) devrede.
deÄŸiÅŸken ozet = sifreci.sha256(ham_veri)

t.dogru_mu(uzunluk(ozet) > 0, "Farkli kutuphaneler zincirleme calisabiliyor.")

// ----------------------------------------------------------------
// 3. BOLUM: ESKI KOD SYNTAX KONTROLU
// ----------------------------------------------------------------
t.bolum("ESKI SÖZDIZIMI (SYNTAX)")

// GümüşDil'de yapilan lexer degisiklikleri (oz vs ben) eski mantigi bozdu mu?
// Burada native if/dÃ¶ngÃ¼ yapilarinin hala hatasiz calistigini teyit ederiz.

deÄŸiÅŸken sayac = 0
dÃ¶ngÃ¼ (sayac < 5) {
    sayac = sayac + 1
}
t.esit_mi(5, sayac, "DÃ¶ngÃ¼ mantigi korundu mu?")

eÄŸer (doÄŸru) {
    t.dogru_mu(doÄŸru, "If blogu calisiyor.")
} degilse {
    t.dogru_mu(yanlÄ±ÅŸ, "If blogu bozulmus!")
}

// ----------------------------------------------------------------
// RAPOR
// ----------------------------------------------------------------
t.raporla()

